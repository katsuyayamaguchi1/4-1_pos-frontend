- name: Assemble deploy folder
        run: |
          rm -rf deploy
          mkdir -p deploy
          # standalone 本体 (server.jsなど) を deploy 直下にコピー
          cp -r .next/standalone/* deploy/
          # public があれば deploy 直下にコピー
          if [ -d "public" ]; then cp -r public deploy/public; fi
          # .next フォルダ全体 (static を含む) を deploy/.next にコピー
          mkdir -p deploy/.next
          cp -r .next/static deploy/.next/static
          # standalone の .next 内に必要なファイルをコピー (next.config.js が必要ない standalone の場合)
          if [ -f ".next/standalone/.next/required-server-files.json" ]; then
            cp -r .next/standalone/.next/* deploy/.next/
          # next.config.js が必要な standalone の場合 (Optional)
          elif [ -f ".next/standalone/next.config.js" ]; then
             cp .next/standalone/next.config.js deploy/
          fi
